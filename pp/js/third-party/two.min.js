(function(){var w=this;var k=w._;var D={};var C=Array.prototype,f=Object.prototype,r=Function.prototype;var H=C.push,o=C.slice,y=C.concat,d=f.toString,j=f.hasOwnProperty;var L=C.forEach,q=C.map,E=C.reduce,c=C.reduceRight,b=C.filter,B=C.every,p=C.some,n=C.indexOf,l=C.lastIndexOf,u=Array.isArray,e=Object.keys,F=r.bind;var M=function(N){if(N instanceof M){return N}if(!(this instanceof M)){return new M(N)}this._wrapped=N};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=M}exports._=M}else{w._=M}M.VERSION="1.5.1";var I=M.each=M.forEach=function(S,R,Q){if(S==null){return}if(L&&S.forEach===L){S.forEach(R,Q)}else{if(S.length===+S.length){for(var P=0,N=S.length;P<N;P++){if(R.call(Q,S[P],P,S)===D){return}}}else{for(var O in S){if(M.has(S,O)){if(R.call(Q,S[O],O,S)===D){return}}}}}};M.map=M.collect=function(Q,P,O){var N=[];if(Q==null){return N}if(q&&Q.map===q){return Q.map(P,O)}I(Q,function(T,R,S){N.push(P.call(O,T,R,S))});return N};var g="Reduce of empty array with no initial value";M.reduce=M.foldl=M.inject=function(R,Q,N,P){var O=arguments.length>2;if(R==null){R=[]}if(E&&R.reduce===E){if(P){Q=M.bind(Q,P)}return O?R.reduce(Q,N):R.reduce(Q)}I(R,function(U,S,T){if(!O){N=U;O=true}else{N=Q.call(P,N,U,S,T)}});if(!O){throw new TypeError(g)}return N};M.reduceRight=M.foldr=function(T,Q,N,P){var O=arguments.length>2;if(T==null){T=[]}if(c&&T.reduceRight===c){if(P){Q=M.bind(Q,P)}return O?T.reduceRight(Q,N):T.reduceRight(Q)}var S=T.length;if(S!==+S){var R=M.keys(T);S=R.length}I(T,function(W,U,V){U=R?R[--S]:--S;if(!O){N=T[U];O=true}else{N=Q.call(P,N,T[U],U,V)}});if(!O){throw new TypeError(g)}return N};M.find=M.detect=function(Q,P,O){var N;A(Q,function(T,R,S){if(P.call(O,T,R,S)){N=T;return true}});return N};M.filter=M.select=function(Q,P,O){var N=[];if(Q==null){return N}if(b&&Q.filter===b){return Q.filter(P,O)}I(Q,function(T,R,S){if(P.call(O,T,R,S)){N.push(T)}});return N};M.reject=function(P,O,N){return M.filter(P,function(S,Q,R){return !O.call(N,S,Q,R)},N)};M.every=M.all=function(Q,P,O){P||(P=M.identity);var N=true;if(Q==null){return N}if(B&&Q.every===B){return Q.every(P,O)}I(Q,function(T,R,S){if(!(N=N&&P.call(O,T,R,S))){return D}});return !!N};var A=M.some=M.any=function(Q,P,O){P||(P=M.identity);var N=false;if(Q==null){return N}if(p&&Q.some===p){return Q.some(P,O)}I(Q,function(T,R,S){if(N||(N=P.call(O,T,R,S))){return D}});return !!N};M.contains=M.include=function(O,N){if(O==null){return false}if(n&&O.indexOf===n){return O.indexOf(N)!=-1}return A(O,function(P){return P===N})};M.invoke=function(P,Q){var N=o.call(arguments,2);var O=M.isFunction(Q);return M.map(P,function(R){return(O?Q:R[Q]).apply(R,N)})};M.pluck=function(O,N){return M.map(O,function(P){return P[N]})};M.where=function(O,N,P){if(M.isEmpty(N)){return P?void 0:[]}return M[P?"find":"filter"](O,function(R){for(var Q in N){if(N[Q]!==R[Q]){return false}}return true})};M.findWhere=function(O,N){return M.where(O,N,true)};M.max=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.max.apply(Math,Q)}if(!P&&M.isEmpty(Q)){return -Infinity}var N={computed:-Infinity,value:-Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S>N.computed&&(N={value:U,computed:S})});return N.value};M.min=function(Q,P,O){if(!P&&M.isArray(Q)&&Q[0]===+Q[0]&&Q.length<65535){return Math.min.apply(Math,Q)}if(!P&&M.isEmpty(Q)){return Infinity}var N={computed:Infinity,value:Infinity};I(Q,function(U,R,T){var S=P?P.call(O,U,R,T):U;S<N.computed&&(N={value:U,computed:S})});return N.value};M.shuffle=function(Q){var P;var O=0;var N=[];I(Q,function(R){P=M.random(O++);N[O-1]=N[P];N[P]=R});return N};var a=function(N){return M.isFunction(N)?N:function(O){return O[N]}};M.sortBy=function(Q,P,N){var O=a(P);return M.pluck(M.map(Q,function(T,R,S){return{value:T,index:R,criteria:O.call(N,T,R,S)}}).sort(function(U,T){var S=U.criteria;var R=T.criteria;if(S!==R){if(S>R||S===void 0){return 1}if(S<R||R===void 0){return -1}}return U.index<T.index?-1:1}),"value")};var t=function(S,R,O,Q){var N={};var P=a(R==null?M.identity:R);I(S,function(V,T){var U=P.call(O,V,T,S);Q(N,U,V)});return N};M.groupBy=function(P,O,N){return t(P,O,N,function(Q,R,S){(M.has(Q,R)?Q[R]:(Q[R]=[])).push(S)})};M.countBy=function(P,O,N){return t(P,O,N,function(Q,R){if(!M.has(Q,R)){Q[R]=0}Q[R]++})};M.sortedIndex=function(U,T,Q,P){Q=Q==null?M.identity:a(Q);var S=Q.call(P,T);var N=0,R=U.length;while(N<R){var O=(N+R)>>>1;Q.call(P,U[O])<S?N=O+1:R=O}return N};M.toArray=function(N){if(!N){return[]}if(M.isArray(N)){return o.call(N)}if(N.length===+N.length){return M.map(N,M.identity)}return M.values(N)};M.size=function(N){if(N==null){return 0}return(N.length===+N.length)?N.length:M.keys(N).length};M.first=M.head=M.take=function(P,O,N){if(P==null){return void 0}return(O!=null)&&!N?o.call(P,0,O):P[0]};M.initial=function(P,O,N){return o.call(P,0,P.length-((O==null)||N?1:O))};M.last=function(P,O,N){if(P==null){return void 0}if((O!=null)&&!N){return o.call(P,Math.max(P.length-O,0))}else{return P[P.length-1]}};M.rest=M.tail=M.drop=function(P,O,N){return o.call(P,(O==null)||N?1:O)};M.compact=function(N){return M.filter(N,M.identity)};var x=function(O,P,N){if(P&&M.every(O,M.isArray)){return y.apply(N,O)}I(O,function(Q){if(M.isArray(Q)||M.isArguments(Q)){P?H.apply(N,Q):x(Q,P,N)}else{N.push(Q)}});return N};M.flatten=function(O,N){return x(O,N,[])};M.without=function(N){return M.difference(N,o.call(arguments,1))};M.uniq=M.unique=function(T,S,R,Q){if(M.isFunction(S)){Q=R;R=S;S=false}var O=R?M.map(T,R,Q):T;var P=[];var N=[];I(O,function(V,U){if(S?(!U||N[N.length-1]!==V):!M.contains(N,V)){N.push(V);P.push(T[U])}});return P};M.union=function(){return M.uniq(M.flatten(arguments,true))};M.intersection=function(O){var N=o.call(arguments,1);return M.filter(M.uniq(O),function(P){return M.every(N,function(Q){return M.indexOf(Q,P)>=0})})};M.difference=function(O){var N=y.apply(C,o.call(arguments,1));return M.filter(O,function(P){return !M.contains(N,P)})};M.zip=function(){var P=M.max(M.pluck(arguments,"length").concat(0));var O=new Array(P);for(var N=0;N<P;N++){O[N]=M.pluck(arguments,""+N)}return O};M.object=function(R,P){if(R==null){return{}}var N={};for(var Q=0,O=R.length;Q<O;Q++){if(P){N[R[Q]]=P[Q]}else{N[R[Q][0]]=R[Q][1]}}return N};M.indexOf=function(R,P,Q){if(R==null){return -1}var O=0,N=R.length;if(Q){if(typeof Q=="number"){O=(Q<0?Math.max(0,N+Q):Q)}else{O=M.sortedIndex(R,P);return R[O]===P?O:-1}}if(n&&R.indexOf===n){return R.indexOf(P,Q)}for(;O<N;O++){if(R[O]===P){return O}}return -1};M.lastIndexOf=function(R,P,Q){if(R==null){return -1}var N=Q!=null;if(l&&R.lastIndexOf===l){return N?R.lastIndexOf(P,Q):R.lastIndexOf(P)}var O=(N?Q:R.length);while(O--){if(R[O]===P){return O}}return -1};M.range=function(S,Q,R){if(arguments.length<=1){Q=S||0;S=0}R=arguments[2]||1;var O=Math.max(Math.ceil((Q-S)/R),0);var N=0;var P=new Array(O);while(N<O){P[N++]=S;S+=R}return P};var G=function(){};M.bind=function(Q,O){var N,P;if(F&&Q.bind===F){return F.apply(Q,o.call(arguments,1))}if(!M.isFunction(Q)){throw new TypeError}N=o.call(arguments,2);return P=function(){if(!(this instanceof P)){return Q.apply(O,N.concat(o.call(arguments)))}G.prototype=Q.prototype;var S=new G;G.prototype=null;var R=Q.apply(S,N.concat(o.call(arguments)));if(Object(R)===R){return R}return S}};M.partial=function(O){var N=o.call(arguments,1);return function(){return O.apply(this,N.concat(o.call(arguments)))}};M.bindAll=function(O){var N=o.call(arguments,1);if(N.length===0){throw new Error("bindAll must be passed function names")}I(N,function(P){O[P]=M.bind(O[P],O)});return O};M.memoize=function(P,O){var N={};O||(O=M.identity);return function(){var Q=O.apply(this,arguments);return M.has(N,Q)?N[Q]:(N[Q]=P.apply(this,arguments))}};M.delay=function(O,P){var N=o.call(arguments,2);return setTimeout(function(){return O.apply(null,N)},P)};M.defer=function(N){return M.delay.apply(M,[N,1].concat(o.call(arguments,1)))};M.throttle=function(O,Q,U){var N,S,V;var T=null;var R=0;U||(U={});var P=function(){R=U.leading===false?0:new Date;T=null;V=O.apply(N,S)};return function(){var W=new Date;if(!R&&U.leading===false){R=W}var X=Q-(W-R);N=this;S=arguments;if(X<=0){clearTimeout(T);T=null;R=W;V=O.apply(N,S)}else{if(!T&&U.trailing!==false){T=setTimeout(P,X)}}return V}};M.debounce=function(P,R,O){var N;var Q=null;return function(){var V=this,U=arguments;var T=function(){Q=null;if(!O){N=P.apply(V,U)}};var S=O&&!Q;clearTimeout(Q);Q=setTimeout(T,R);if(S){N=P.apply(V,U)}return N}};M.once=function(P){var N=false,O;return function(){if(N){return O}N=true;O=P.apply(this,arguments);P=null;return O}};M.wrap=function(N,O){return function(){var P=[N];H.apply(P,arguments);return O.apply(this,P)}};M.compose=function(){var N=arguments;return function(){var O=arguments;for(var P=N.length-1;P>=0;P--){O=[N[P].apply(this,O)]}return O[0]}};M.after=function(O,N){return function(){if(--O<1){return N.apply(this,arguments)}}};M.keys=e||function(P){if(P!==Object(P)){throw new TypeError("Invalid object")}var O=[];for(var N in P){if(M.has(P,N)){O.push(N)}}return O};M.values=function(P){var N=[];for(var O in P){if(M.has(P,O)){N.push(P[O])}}return N};M.pairs=function(P){var O=[];for(var N in P){if(M.has(P,N)){O.push([N,P[N]])}}return O};M.invert=function(P){var N={};for(var O in P){if(M.has(P,O)){N[P[O]]=O}}return N};M.functions=M.methods=function(P){var O=[];for(var N in P){if(M.isFunction(P[N])){O.push(N)}}return O.sort()};M.extend=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){N[P]=O[P]}}});return N};M.pick=function(O){var P={};var N=y.apply(C,o.call(arguments,1));I(N,function(Q){if(Q in O){P[Q]=O[Q]}});return P};M.omit=function(P){var Q={};var O=y.apply(C,o.call(arguments,1));for(var N in P){if(!M.contains(O,N)){Q[N]=P[N]}}return Q};M.defaults=function(N){I(o.call(arguments,1),function(O){if(O){for(var P in O){if(N[P]===void 0){N[P]=O[P]}}}});return N};M.clone=function(N){if(!M.isObject(N)){return N}return M.isArray(N)?N.slice():M.extend({},N)};M.tap=function(O,N){N(O);return O};var J=function(U,T,O,P){if(U===T){return U!==0||1/U==1/T}if(U==null||T==null){return U===T}if(U instanceof M){U=U._wrapped}if(T instanceof M){T=T._wrapped}var R=d.call(U);if(R!=d.call(T)){return false}switch(R){case"[object String]":return U==String(T);case"[object Number]":return U!=+U?T!=+T:(U==0?1/U==1/T:U==+T);case"[object Date]":case"[object Boolean]":return +U==+T;case"[object RegExp]":return U.source==T.source&&U.global==T.global&&U.multiline==T.multiline&&U.ignoreCase==T.ignoreCase}if(typeof U!="object"||typeof T!="object"){return false}var N=O.length;while(N--){if(O[N]==U){return P[N]==T}}var S=U.constructor,Q=T.constructor;if(S!==Q&&!(M.isFunction(S)&&(S instanceof S)&&M.isFunction(Q)&&(Q instanceof Q))){return false}O.push(U);P.push(T);var X=0,W=true;if(R=="[object Array]"){X=U.length;W=X==T.length;if(W){while(X--){if(!(W=J(U[X],T[X],O,P))){break}}}}else{for(var V in U){if(M.has(U,V)){X++;if(!(W=M.has(T,V)&&J(U[V],T[V],O,P))){break}}}if(W){for(V in T){if(M.has(T,V)&&!(X--)){break}}W=!X}}O.pop();P.pop();return W};M.isEqual=function(O,N){return J(O,N,[],[])};M.isEmpty=function(O){if(O==null){return true}if(M.isArray(O)||M.isString(O)){return O.length===0}for(var N in O){if(M.has(O,N)){return false}}return true};M.isElement=function(N){return !!(N&&N.nodeType===1)};M.isArray=u||function(N){return d.call(N)=="[object Array]"};M.isObject=function(N){return N===Object(N)};I(["Arguments","Function","String","Number","Date","RegExp"],function(N){M["is"+N]=function(O){return d.call(O)=="[object "+N+"]"}});if(!M.isArguments(arguments)){M.isArguments=function(N){return !!(N&&M.has(N,"callee"))}}if(typeof(/./)!=="function"){M.isFunction=function(N){return typeof N==="function"}}M.isFinite=function(N){return isFinite(N)&&!isNaN(parseFloat(N))};M.isNaN=function(N){return M.isNumber(N)&&N!=+N};M.isBoolean=function(N){return N===true||N===false||d.call(N)=="[object Boolean]"};M.isNull=function(N){return N===null};M.isUndefined=function(N){return N===void 0};M.has=function(O,N){return j.call(O,N)};M.noConflict=function(){w._=k;return this};M.identity=function(N){return N};M.times=function(R,Q,P){var N=Array(Math.max(0,R));for(var O=0;O<R;O++){N[O]=Q.call(P,O)}return N};M.random=function(O,N){if(N==null){N=O;O=0}return O+Math.floor(Math.random()*(N-O+1))};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=M.invert(m.escape);var K={escape:new RegExp("["+M.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+M.keys(m.unescape).join("|")+")","g")};M.each(["escape","unescape"],function(N){M[N]=function(O){if(O==null){return""}return(""+O).replace(K[N],function(P){return m[N][P]})}});M.result=function(N,P){if(N==null){return void 0}var O=N[P];return M.isFunction(O)?O.call(N):O};M.mixin=function(N){I(M.functions(N),function(O){var P=M[O]=N[O];M.prototype[O]=function(){var Q=[this._wrapped];H.apply(Q,arguments);return s.call(this,P.apply(M,Q))}})};var z=0;M.uniqueId=function(N){var O=++z+"";return N?N+O:O};M.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;M.template=function(V,Q,P){var O;P=M.defaults({},P,M.templateSettings);var R=new RegExp([(P.escape||v).source,(P.interpolate||v).source,(P.evaluate||v).source].join("|")+"|$","g");var S=0;var N="__p+='";V.replace(R,function(X,Y,W,aa,Z){N+=V.slice(S,Z).replace(i,function(ab){return"\\"+h[ab]});if(Y){N+="'+\n((__t=("+Y+"))==null?'':_.escape(__t))+\n'"}if(W){N+="'+\n((__t=("+W+"))==null?'':__t)+\n'"}if(aa){N+="';\n"+aa+"\n__p+='"}S=Z+X.length;return X});N+="';\n";if(!P.variable){N="with(obj||{}){\n"+N+"}\n"}N="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+N+"return __p;\n";try{O=new Function(P.variable||"obj","_",N)}catch(T){T.source=N;throw T}if(Q){return O(Q,M)}var U=function(W){return O.call(this,W,M)};U.source="function("+(P.variable||"obj")+"){\n"+N+"}";return U};M.chain=function(N){return M(N).chain()};var s=function(N){return this._chain?M(N).chain():N};M.mixin(M);I(["pop","push","reverse","shift","sort","splice","unshift"],function(N){var O=C[N];M.prototype[N]=function(){var P=this._wrapped;O.apply(P,arguments);if((N=="shift"||N=="splice")&&P.length===0){delete P[0]}return s.call(this,P)}});I(["concat","join","slice"],function(N){var O=C[N];M.prototype[N]=function(){return s.call(this,O.apply(this._wrapped,arguments))}});M.extend(M.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);var Backbone=Backbone||{};(function(){var e=[];var d=e.slice;var b=/\s+/;var c=function(m,j,g){var k,h=-1,f=j.length;switch(g.length){case 0:while(++h<f){(k=j[h]).callback.call(k.ctx)}return;case 1:while(++h<f){(k=j[h]).callback.call(k.ctx,g[0])}return;case 2:while(++h<f){(k=j[h]).callback.call(k.ctx,g[0],g[1])}return;case 3:while(++h<f){(k=j[h]).callback.call(k.ctx,g[0],g[1],g[2])}return;default:while(++h<f){(k=j[h]).callback.apply(k.ctx,g)}}};var a=Backbone.Events={on:function(f,i,g){this._events||(this._events={});var h=this._events[f]||(this._events[f]=[]);h.push({callback:i,context:g,ctx:g||this});return this},once:function(g,j,h){var f=this;var i=_.once(function(){f.off(g,i);j.apply(this,arguments)});i._callback=j;this.on(g,i,h);return this},off:function(f,s,g){var p,r,t,q,o,h,n,m;if(!this._events){return this}if(!f&&!s&&!g){this._events={};return this}q=f?[f]:_.keys(this._events);for(o=0,h=q.length;o<h;o++){f=q[o];if(p=this._events[f]){t=[];if(s||g){for(n=0,m=p.length;n<m;n++){r=p[n];if((s&&s!==(r.callback._callback||r.callback))||(g&&g!==r.context)){t.push(r)}}}this._events[f]=t}}return this},trigger:function(h){if(!this._events){return this}var g=d.call(arguments,1);var i=this._events[h];var f=this._events.all;if(i){c(this,i,g)}if(f){c(this,f,arguments)}return this},listenTo:function(f,g,j){var h=this._listeners||(this._listeners={});var i=f._listenerId||(f._listenerId=_.uniqueId("l"));h[i]=f;f.on(g,j||this,this);return this},stopListening:function(f,g,j){var h=this._listeners;if(!h){return}if(f){f.off(g,j,this);if(!g&&!j){delete h[f._listenerId]}}else{for(var i in h){h[i].off(null,null,this)}this._listeners={}}return this}};a.bind=a.on;a.unbind=a.off;if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=a}exports.Backbone=exports.Backbone||Backbone}})();(function(){var b=this;var c=0;var e=["ms","moz","webkit","o"];if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=d}exports.requestAnimationFrame=d;return}for(var a=0;a<e.length&&!b.requestAnimationFrame;++a){b.requestAnimationFrame=b[e[a]+"RequestAnimationFrame"];b.cancelAnimationFrame=b[e[a]+"CancelAnimationFrame"]||b[e[a]+"CancelRequestAnimationFrame"]}if(!b.requestAnimationFrame){b.requestAnimationFrame=d}if(!b.cancelAnimationFrame){b.cancelAnimationFrame=function(f){clearTimeout(f)}}function d(j,g){var f=new Date().getTime();var h=Math.max(0,16-(f-c));var i=b.setTimeout(function(){j(f+h)},h);c=f+h;return i}}());(function(){var r=this;var y=r.Two||{};var a=Math.sin,d=Math.cos,f=Math.atan2,B=Math.sqrt,z=Math.round,m=Math.abs,q=Math.PI,x=q*2,g=q/2,h=Math.pow,s=Math.min,u=Math.max;var i=0;var v={hasEventListeners:_.isFunction(r.addEventListener),bind:function(G,F,E,D){if(this.hasEventListeners){G.addEventListener(F,E,!!D)}else{G.attachEvent("on"+F,E)}return this},unbind:function(G,F,E,D){if(this.hasEventListeners){G.removeEventListeners(F,E,!!D)}else{G.detachEvent("on"+F,E)}return this}};var o=r.Two=function(D){var F=_.defaults(D||{},{fullscreen:false,width:640,height:480,type:o.Types.svg,autostart:false});_.each(F,function(H,G){if(G==="fullscreen"||G==="width"||G==="height"||G==="autostart"){return}this[G]=H},this);if(_.isElement(F.domElement)){this.type=o.Types[F.domElement.tagName.toLowerCase()]}this.renderer=new o[this.type](this);o.Utils.setPlaying.call(this,F.autostart);this.frameCount=0;if(F.fullscreen){var E=_.bind(C,this);_.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"});_.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"});v.bind(r,"resize",E);E()}else{if(!_.isElement(F.domElement)){this.renderer.setSize(F.width,F.height,this.ratio);this.width=F.width;this.height=F.height}}this.scene=this.renderer.scene;o.Instances.push(this)};_.extend(o,{Array:r.Float32Array||Array,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.4.0",Identifier:"two-",Properties:{hierarchy:"hierarchy",demotion:"demotion"},Events:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert"},Commands:{move:"M",line:"L",curve:"C",close:"Z"},Resolution:8,Instances:[],noConflict:function(){r.Two=y;return this},uniqueId:function(){var D=i;i++;return D},Utils:{Curve:{CollinearityEpsilon:h(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:0.25,angle:0,epsilon:0.01}},devicePixelRatio:r.devicePixelRatio||1,getBackingStoreRatio:function(D){return D.webkitBackingStorePixelRatio||D.mozBackingStorePixelRatio||D.msBackingStorePixelRatio||D.oBackingStorePixelRatio||D.backingStorePixelRatio||1},getRatio:function(D){return o.Utils.devicePixelRatio/p(D)},setPlaying:function(D){this.playing=!!D;return this},getComputedMatrix:function(E,D){var D=(D&&D.identity())||new o.Matrix();var F=E;while(F&&F._matrix){var G=F._matrix.elements;D.multiply(G[0],G[1],G[2],G[3],G[4],G[5],G[6],G[7],G[8],G[9]);F=F.parent}return D},applySvgAttributes:function(E,D){D.cap="butt";D.join="bevel";_.each(E.attributes,function(G,F){var H=G.nodeName;switch(H){case"transform":break;case"visibility":D.visible=!!G.nodeValue;break;case"stroke-linecap":D.cap=G.nodeValue;break;case"stroke-linejoin":D.join=G.nodeValue;break;case"stroke-miterlimit":D.miter=G.nodeValue;break;case"stroke-width":D.linewidth=parseFloat(G.nodeValue);break;case"stroke-opacity":case"fill-opacity":D.opacity=G.nodeValue;break;case"fill":D.fill=G.nodeValue;break;case"stroke":D.stroke=G.nodeValue;break}});return D},read:{svg:function(){return o.Utils.read.g.apply(this,arguments)},g:function(D){var E=new o.Group();this.add(E);_.each(D.childNodes,function(I){var F=I.nodeName;if(!F){return}var G=F.replace(/svg\:/ig,"").toLowerCase();if(G in o.Utils.read){var H=o.Utils.read[G].call(this,I);E.add(H)}},this);return o.Utils.applySvgAttributes(D,E)},polygon:function(F,D){var E=F.getAttribute("points");var H=[];E.replace(/([\d\.?]+),([\d\.?]+)/g,function(I,K,J){H.push(new o.Anchor(parseFloat(K),parseFloat(J)))});var G=new o.Polygon(H,!D).noStroke();return o.Utils.applySvgAttributes(F,G)},polyline:function(D){return o.Utils.read.polygon(D,true)},path:function(G){var N=G.getAttribute("d");var I,H;var K,E=false;var J=false;var F=N.match(/[a-df-z][^a-df-z]*/ig);var M=F.length-1;var L=_.flatten(_.map(F,function(T,Y){var W,V,U;var S=T[0];var af=S.toLowerCase();K=T.slice(1).trim();K=K.replace(/(-?\d+(?:\.\d*)?)[eE]([+\-]?\d+)/g,function(ag,ai,ah){return parseFloat(ai)*Math.pow(10,ah)});K=K.split(/[\s,]+|(?=\s?[+\-])/);E=S===af;var ab,R,aa,Q,Z,P,X,O,ad;switch(af){case"z":if(Y>=M){J=true}else{V=I.x;U=I.y;W=new o.Anchor(V,U,undefined,undefined,undefined,undefined,o.Commands.close)}break;case"m":case"l":V=parseFloat(K[0]);U=parseFloat(K[1]);W=new o.Anchor(V,U,undefined,undefined,undefined,undefined,af==="m"?o.Commands.move:o.Commands.line);if(E){W.addSelf(I)}W.controls.left.copy(W);W.controls.right.copy(W);I=W;break;case"h":case"v":var ae=af==="h"?"x":"y";var ac=ae==="x"?"y":"x";W=new o.Anchor(undefined,undefined,undefined,undefined,undefined,undefined,o.Commands.line);W[ae]=parseFloat(K[0]);W[ac]=I[ac];if(E){W[ae]+=I[ae]}W.controls.left.copy(W);W.controls.right.copy(W);I=W;break;case"s":case"c":ab=I.x,R=I.y;if(!H){H=new o.Vector().copy(I)}if(af==="c"){aa=parseFloat(K[0]),Q=parseFloat(K[1]);Z=parseFloat(K[2]),P=parseFloat(K[3]);X=parseFloat(K[4]),O=parseFloat(K[5])}else{ad=o.Utils.getReflection(I,H,E);aa=ad.x,Q=ad.y;Z=parseFloat(K[0]),P=parseFloat(K[1]);X=parseFloat(K[2]),O=parseFloat(K[3])}if(E){aa+=ab,Q+=R;Z+=ab,P+=R;X+=ab,O+=R}if(!_.isObject(I.controls)){o.Anchor.AppendCurveProperties(I)}I.controls.right.set(aa,Q);W=new o.Anchor(X,O,Z,P,undefined,undefined,o.Commands.curve);I=W;H=W.controls.left;break;case"t":case"q":ab=I.x,R=I.y;if(!H){H=new o.Vector().copy(I)}if(H.isZero()){aa=ab,Q=R}else{aa=H.x,R=H.y}if(af==="q"){Z=parseFloat(K[0]),P=parseFloat(K[1]);X=parseFloat(K[1]),O=parseFloat(K[2])}else{ad=o.Utils.getReflection(I,H,E);Z=ad.x,P=ad.y;X=parseFloat(K[0]),O=parseFloat(K[1])}if(E){aa+=ab,Q+=R;Z+=ab,P+=R;X+=ab,O+=R}if(!_.isObject(I.controls)){o.Anchor.AppendCurveProperties(I)}I.controls.right.set(aa,Q);W=new o.Anchor(X,O,Z,P,undefined,undefined,o.Commands.curve);I=W;H=W.controls.left;break;case"a":throw new o.Utils.Error("not yet able to interpret Elliptical Arcs.")}return W}));if(L.length<=1){return}L=_.compact(L);var D=new o.Polygon(L,J,undefined,true).noStroke();return o.Utils.applySvgAttributes(G,D)},circle:function(H){var D=parseFloat(H.getAttribute("cx"));var J=parseFloat(H.getAttribute("cy"));var G=parseFloat(H.getAttribute("r"));var E=o.Resolution;var F=_.map(_.range(E),function(M){var N=M/E;var L=N*x;var K=G*d(L);var O=G*a(L);return new o.Anchor(K,O)},this);var I=new o.Polygon(F,true,true).noStroke();I.translation.set(D,J);return o.Utils.applySvgAttributes(H,I)},ellipse:function(J){var E=parseFloat(J.getAttribute("cx"));var K=parseFloat(J.getAttribute("cy"));var H=parseFloat(J.getAttribute("rx"));var D=parseFloat(J.getAttribute("ry"));var F=o.Resolution;var G=_.map(_.range(F),function(N){var O=N/F;var M=O*x;var L=H*d(M);var P=D*a(M);return new o.Anchor(L,P)},this);var I=new o.Polygon(G,true,true).noStroke();I.translation.set(E,K);return o.Utils.applySvgAttributes(J,I)},rect:function(E){var J=parseFloat(E.getAttribute("x"));var I=parseFloat(E.getAttribute("y"));var D=parseFloat(E.getAttribute("width"));var L=parseFloat(E.getAttribute("height"));var F=D/2;var G=L/2;var K=[new o.Anchor(F,G),new o.Anchor(-F,G),new o.Anchor(-F,-G),new o.Anchor(F,-G)];var H=new o.Polygon(K,true).noStroke();H.translation.set(J+F,I+G);return o.Utils.applySvgAttributes(E,H)},line:function(G){var F=parseFloat(G.getAttribute("x1"));var K=parseFloat(G.getAttribute("y1"));var D=parseFloat(G.getAttribute("x2"));var J=parseFloat(G.getAttribute("y2"));var E=D-F;var M=J-K;var H=E/2;var I=M/2;var L=[new o.Anchor(-H,-I),new o.Anchor(H,I)];var N=new o.Polygon(L).noFill();N.translation.set(F+H,K+I);return o.Utils.applySvgAttributes(G,N)}},subdivide:function(F,L,E,K,D,J,M,I,G){var G=G||o.Utils.Curve.RecursionLimit;var H=G+1;return _.map(_.range(0,H),function(P){var O=P/H;var N=j(O,F,E,D,M);var Q=j(O,L,K,J,I);return new o.Anchor(N,Q)})},getPointOnCubicBezier:function(G,E,D,I,H){var F=1-G;return(F*F*F*E)+(3*F*F*G*D)+(3*F*G*G*I)+(G*G*G*H)},getCurveFromPoints:function(N,H){var E=N.length,M=E-1;for(var F=0;F<E;F++){var L=N[F];if(!_.isObject(L.controls)){o.Anchor.AppendCurveProperties(L)}var D=H?A(F-1,E):Math.max(F-1,0);var G=H?A(F+1,E):Math.min(F+1,M);var K=N[D];var J=L;var I=N[G];b(K,J,I);J._command=F===0?o.Commands.move:o.Commands.curve;J.controls.left.x=_.isNumber(J.controls.left.x)?J.controls.left.x:J.x;J.controls.left.y=_.isNumber(J.controls.left.y)?J.controls.left.y:J.y;J.controls.right.x=_.isNumber(J.controls.right.x)?J.controls.right.x:J.x;J.controls.right.y=_.isNumber(J.controls.right.y)?J.controls.right.y:J.y}},getControlPoints:function(G,E,K){var F=c(G,E);var D=c(K,E);var J=k(G,E);var I=k(K,E);var H=(F+D)/2;E.u=_.isObject(E.controls.left)?E.controls.left:new o.Vector(E.x,E.y);E.v=_.isObject(E.controls.right)?E.controls.right:new o.Vector(E.x,E.y);if(J<0.0001||I<0.0001){E.controls.left.copy(E);E.controls.right.copy(E);return E}J*=0.33;I*=0.33;if(D<F){H+=g}else{H-=g}E.controls.left.x=E.x+d(H)*J;E.controls.left.y=E.y+a(H)*J;H-=q;E.controls.right.x=E.x+d(H)*I;E.controls.right.y=E.y+a(H)*I;return E},getReflection:function(E,D,G){var H=E.distanceTo(D);if(H<=0.0001){return G?new o.Vector():E.clone()}var F=c(E,D);return new o.Vector(H*Math.cos(F)+(G?0:E.x),H*Math.sin(F)+(G?0:E.y))},angleBetween:function(D,G){var F,E;if(arguments.length>=4){F=arguments[0]-arguments[2];E=arguments[1]-arguments[3];return f(E,F)}F=D.x-G.x;E=D.y-G.y;return f(E,F)},distanceBetweenSquared:function(G,F){var E=G.x-F.x;var D=G.y-F.y;return E*E+D*D},distanceBetween:function(E,D){return B(l(E,D))},mod:function(E,D){while(E<0){E+=D}return E%D},Collection:function(){Array.call(this);if(arguments.length>1){Array.prototype.push.apply(this,arguments)}else{if(arguments[0]&&Array.isArray(arguments[0])){Array.prototype.push.apply(this,arguments[0])}}},Error:function(D){this.name="two.js";this.message=D}}});o.Utils.Error.prototype=new Error();o.Utils.Error.prototype.constructor=o.Utils.Error;o.Utils.Collection.prototype=new Array();o.Utils.Collection.constructor=o.Utils.Collection;_.extend(o.Utils.Collection.prototype,Backbone.Events,{pop:function(){var D=Array.prototype.pop.apply(this,arguments);this.trigger(o.Events.remove,[D]);return D},shift:function(){var D=Array.prototype.shift.apply(this,arguments);this.trigger(o.Events.remove,[D]);return D},push:function(){var D=Array.prototype.push.apply(this,arguments);this.trigger(o.Events.insert,arguments);return D},unshift:function(){var D=Array.prototype.unshift.apply(this,arguments);this.trigger(o.Events.insert,arguments);return D},splice:function(){var D=Array.prototype.splice.apply(this,arguments);var E;this.trigger(o.Events.remove,D);if(arguments.length>2){E=this.slice(arguments[0],arguments.length-2);this.trigger(o.Events.insert,E)}return D}});var k=o.Utils.distanceBetween,l=o.Utils.distanceBetweenSquared,c=o.Utils.angleBetween,b=o.Utils.getControlPoints,w=o.Utils.getCurveFromPoints,t=o.Utils.solveSegmentIntersection,e=o.Utils.decoupleShapes,A=o.Utils.mod,p=o.Utils.getBackingStoreRatio,j=o.Utils.getPointOnCubicBezier;_.extend(o.prototype,Backbone.Events,{appendTo:function(D){D.appendChild(this.renderer.domElement);return this},play:function(){o.Utils.setPlaying.call(this,true);return this.trigger(o.Events.play)},pause:function(){this.playing=false;return this.trigger(o.Events.pause)},update:function(){var G=!!this._lastFrame;var E=n();this.frameCount++;if(G){this.timeDelta=parseFloat((E-this._lastFrame).toFixed(3))}this._lastFrame=E;var F=this.width;var D=this.height;var H=this.renderer;if(F!==H.width||D!==H.height){H.setSize(F,D,this.ratio)}this.trigger(o.Events.update,this.frameCount,this.timeDelta);return this.render()},render:function(){this.renderer.render();return this.trigger(o.Events.render,this.frameCount)},add:function(E){var D=E;if(!_.isArray(E)){D=_.toArray(arguments)}this.scene.add(D);return this},remove:function(E){var D=E;if(!_.isArray(E)){D=_.toArray(arguments)}this.scene.remove(D);return this},clear:function(){this.scene.remove(_.toArray(this.scene.children));return this},makeLine:function(F,J,D,I){var E=D-F;var L=I-J;var G=E/2;var H=L/2;var K=[new o.Anchor(-G,-H),new o.Anchor(G,H)];var M=new o.Polygon(K).noFill();M.translation.set(F+G,J+H);this.scene.add(M);return M},makeRectangle:function(F,K,I,E){var D=I/2;var G=E/2;var H=[new o.Anchor(D,G),new o.Anchor(-D,G),new o.Anchor(-D,-G),new o.Anchor(D,-G)];var J=new o.Polygon(H,true);J.translation.set(F,K);this.scene.add(J);return J},makeCircle:function(E,D,F){return this.makeEllipse(E,D,F,F)},makeEllipse:function(F,E,I,D){var G=o.Resolution;var H=_.map(_.range(G),function(M){var N=M/G;var L=N*x;var K=I*d(L);var O=D*a(L);return new o.Anchor(K,O)},this);var J=new o.Polygon(H,true,true);J.translation.set(F,E);this.scene.add(J);return J},makeCurve:function(E){var G=arguments.length,N=E;if(!_.isArray(E)){N=[];for(var I=0;I<G;I+=2){var L=arguments[I];if(!_.isNumber(L)){break}var K=arguments[I+1];N.push(new o.Anchor(L,K))}}var M=arguments[G-1];var D=new o.Polygon(N,!(_.isBoolean(M)?M:undefined),true);var J=D.getBoundingClientRect();var H=J.left+J.width/2;var F=J.top+J.height/2;_.each(D.vertices,function(O){O.x-=H;O.y-=F});D.translation.set(H,F);this.scene.add(D);return D},makePolygon:function(E){var F=arguments.length,L=E;if(!_.isArray(E)){L=[];for(var G=0;G<F;G+=2){var J=arguments[G];if(!_.isNumber(J)){break}var I=arguments[G+1];L.push(new o.Anchor(J,I))}}var K=arguments[F-1];var D=new o.Polygon(L,!(_.isBoolean(K)?K:undefined));var H=D.getBoundingClientRect();D.center().translation.set(H.left+H.width/2,H.top+H.height/2);this.scene.add(D);return D},makeGroup:function(F){var D=F;if(!_.isArray(F)){D=_.toArray(arguments)}var E=new o.Group();this.scene.add(E);E.add(D);return E},interpret:function(F){var D=F.tagName.toLowerCase();if(!(D in o.Utils.read)){return null}var E=o.Utils.read[D].call(this,F);this.add(E);return E}});function C(){var E=document.body.getBoundingClientRect();var F=this.width=E.width;var D=this.height=E.height;this.renderer.setSize(F,D,this.ratio);this.trigger(o.Events.resize,F,D)}function n(){return((r.performance&&r.performance.now)?r.performance:Date).now()}(function(){requestAnimationFrame(arguments.callee);_.each(o.Instances,function(D){if(D.playing){D.update()}})})();if(typeof define==="function"&&define.amd){define(function(){return o})}else{if(typeof module!="undefined"&&module.exports){module.exports=o}}})();(function(){var h,d,g,e,j,i;var c=Two.Vector=function(k,l){this.x=k||0;this.y=l||0};_.extend(c.prototype,Backbone.Events,{set:function(k,l){this.x=k;this.y=l;return this},copy:function(k){this.x=k.x;this.y=k.y;return this},clear:function(){this.x=0;this.y=0;return this},clone:function(){return new c(this.x,this.y)},add:function(l,k){this.x=l.x+k.x;this.y=l.y+k.y;return this},addSelf:function(k){this.x+=k.x;this.y+=k.y;return this},sub:function(l,k){this.x=l.x-k.x;this.y=l.y-k.y;return this},subSelf:function(k){this.x-=k.x;this.y-=k.y;return this},multiplySelf:function(k){this.x*=k.x;this.y*=k.y;return this},multiplyScalar:function(k){this.x*=k;this.y*=k;return this},divideScalar:function(k){if(k){this.x/=k;this.y/=k}else{this.set(0,0)}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(k){return this.x*k.x+this.y*k.y},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(k){return Math.sqrt(this.distanceToSquared(k))},distanceToSquared:function(k){j=this.x-k.x,i=this.y-k.y;return j*j+i*i},setLength:function(k){return this.normalize().multiplyScalar(k)},equals:function(k){return(this.distanceTo(k)<0.0001)},lerp:function(k,l){g=(k.x-this.x)*l+this.x;e=(k.y-this.y)*l+this.y;return this.set(g,e)},isZero:function(){return(this.length()<0.0001)},toString:function(){return this.x+","+this.y},toObject:function(){return{x:this.x,y:this.y}}});var f={set:function(k,l){this._x=k;this._y=l;return this.trigger(Two.Events.change)},copy:function(k){this._x=k.x;this._y=k.y;return this.trigger(Two.Events.change)},clear:function(){this._x=0;this._y=0;return this.trigger(Two.Events.change)},clone:function(){return new c(this._x,this._y)},add:function(l,k){this._x=l.x+k.x;this._y=l.y+k.y;return this.trigger(Two.Events.change)},addSelf:function(k){this._x+=k.x;this._y+=k.y;return this.trigger(Two.Events.change)},sub:function(l,k){this._x=l.x-k.x;this._y=l.y-k.y;return this.trigger(Two.Events.change)},subSelf:function(k){this._x-=k.x;this._y-=k.y;return this.trigger(Two.Events.change)},multiplySelf:function(k){this._x*=k.x;this._y*=k.y;return this.trigger(Two.Events.change)},multiplyScalar:function(k){this._x*=k;this._y*=k;return this.trigger(Two.Events.change)},divideScalar:function(k){if(k){this._x/=k;this._y/=k;return this.trigger(Two.Events.change)}return this.clear()},negate:function(){return this.multiplyScalar(-1)},dot:function(k){return this._x*k.x+this._y*k.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},length:function(){return Math.sqrt(this.lengthSquared())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(k){return Math.sqrt(this.distanceToSquared(k))},distanceToSquared:function(k){j=this._x-k.x,i=this._y-k.y;return j*j+i*i},setLength:function(k){return this.normalize().multiplyScalar(k)},equals:function(k){return(this.distanceTo(k)<0.0001)},lerp:function(k,l){g=(k.x-this._x)*l+this._x;e=(k.y-this._y)*l+this._y;return this.set(g,e)},isZero:function(){return(this.length()<0.0001)},toString:function(){return this._x+","+this._y},toObject:function(){return{x:this._x,y:this._y}}};var a={get:function(){return this._x},set:function(k){this._x=k;this.trigger(Two.Events.change,"x")}};var b={get:function(){return this._y},set:function(k){this._y=k;this.trigger(Two.Events.change,"y")}};Two.Vector.prototype.bind=Two.Vector.prototype.on=function(){if(!this._bound){this._x=this.x;this._y=this.y;Object.defineProperty(this,"x",a);Object.defineProperty(this,"y",b);_.extend(this,f);this._bound=true}Backbone.Events.bind.apply(this,arguments);return this}})();(function(){var c=Two.Commands,b,f,d;var a=Two.Anchor=function(g,m,i,h,k,j,l){Two.Vector.call(this,g,m);this._broadcast=_.bind(function(){this.trigger(Two.Events.change)},this);Object.defineProperty(this,"command",{get:function(){return this._command},set:function(n){this._command=n;if(this._command===c.curve&&!_.isObject(this.controls)){a.AppendCurveProperties(this)}return this.trigger(Two.Events.change)}});this._command=l||c.move;if(!l){return this}a.AppendCurveProperties(this);if(_.isNumber(i)){this.controls.left.x=i}if(_.isNumber(h)){this.controls.left.y=h}if(_.isNumber(k)){this.controls.right.x=k}if(_.isNumber(j)){this.controls.right.y=j}};_.extend(a,{AppendCurveProperties:function(g){b=g._x||g.x;f=g._y||g.y;g.controls={left:new Two.Vector(b,f),right:new Two.Vector(b,f)}}});var e={listen:function(){if(!_.isObject(this.controls)){a.AppendCurveProperties(this)}_.each(this.controls,function(g){g.bind(Two.Events.change,this._broadcast)},this);return this},ignore:function(){_.each(this.controls,function(g){g.unbind(Two.Events.change,this._broadcast)},this);return this},clone:function(){d=this.controls;return new Two.Anchor(this.x,this.y,d&&d.left.x,d&&d.left.y,d&&d.right.x,d&&d.right.y,this.command)}};_.extend(a.prototype,Two.Vector.prototype,e);Two.Anchor.prototype.bind=Two.Anchor.prototype.on=function(){Two.Vector.prototype.bind.apply(this,arguments);_.extend(this,e)}})();(function(){var r=_.range(6),k=Math.cos,H=Math.sin,X=Math.tan;var aw,av,at,aq,an,ak,ah,af,ae,o,W,m,V,U,T,L,K,J,G,E,w,u,t,q,p,au,ar,ao,al,ai,ag,ad,ac,ab,N,M,aa,Y,at,S,R,Q,I,F,D,ap,am,aj,O,n,Z,v,P=[];var j=Two.Matrix=function(h,g,y,x,s,l){this.elements=new Two.Array(9);var i=h;if(!_.isArray(i)){i=_.toArray(arguments)}this.identity().set(i)};_.extend(j,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(a,c,b){if(c.length<=3){V,U,T;aw=c[0]||0,av=c[1]||0,at=c[2]||0;an=a;V=an[0]*aw+an[1]*av+an[2]*at;U=an[3]*aw+an[4]*av+an[5]*at;T=an[6]*aw+an[7]*av+an[8]*at;return{x:V,y:U,z:T}}K=a[0],J=a[1],G=a[2];E=a[3],w=a[4],u=a[5];t=a[6],q=a[7],p=a[8];au=c[0],ar=c[1],ao=c[2];al=c[3],ai=c[4],ag=c[5];ad=c[6],ac=c[7],ab=c[8];b=b||new Two.Array(9);b[0]=K*au+J*al+G*ad;b[1]=K*ar+J*ai+G*ac;b[2]=K*ao+J*ag+G*ab;b[3]=E*au+w*al+u*ad;b[4]=E*ar+w*ai+u*ac;b[5]=E*ao+w*ag+u*ab;b[6]=t*au+q*al+p*ad;b[7]=t*ar+q*ai+p*ac;b[8]=t*ao+q*ag+p*ab;return b}});_.extend(j.prototype,Backbone.Events,{set:function(h,g,x,s,l,i){m=h,aa=arguments.length;if(!_.isArray(m)){m=_.toArray(arguments)}_.each(m,function(a,b){if(_.isNumber(a)){this.elements[b]=a}},this);return this.trigger(Two.Events.change)},identity:function(){this.set(j.Identity);return this},multiply:function(ax,C,B,A,z,y,x,s,l){m=arguments,aa=m.length;if(aa<=1){_.each(this.elements,function(a,b){this.elements[b]=a*ax},this);return this.trigger(Two.Events.change)}if(aa<=3){V,U,T;ax=ax||0,C=C||0,B=B||0;z=this.elements;V=z[0]*ax+z[1]*C+z[2]*B;U=z[3]*ax+z[4]*C+z[5]*B;T=z[6]*ax+z[7]*C+z[8]*B;return{x:V,y:U,z:T}}N=this.elements;M=m;K=N[0],J=N[1],G=N[2];E=N[3],w=N[4],u=N[5];t=N[6],q=N[7],p=N[8];au=M[0],ar=M[1],ao=M[2];al=M[3],ai=M[4],ag=M[5];ad=M[6],ac=M[7],ab=M[8];this.elements[0]=K*au+J*al+G*ad;this.elements[1]=K*ar+J*ai+G*ac;this.elements[2]=K*ao+J*ag+G*ab;this.elements[3]=E*au+w*al+u*ad;this.elements[4]=E*ar+w*ai+u*ac;this.elements[5]=E*ao+w*ag+u*ab;this.elements[6]=t*au+q*al+p*ad;this.elements[7]=t*ar+q*ai+p*ac;this.elements[8]=t*ao+q*ag+p*ab;return this.trigger(Two.Events.change)},inverse:function(a){aw=this.elements;a=a||new Two.Matrix();S=aw[0],R=aw[1],Q=aw[2];I=aw[3],F=aw[4],D=aw[5];ap=aw[6],am=aw[7],aj=aw[8];O=aj*F-D*am;n=-aj*I+D*ap;Z=am*I-F*ap;v=S*O+R*n+Q*Z;if(!v){return null}v=1/v;a.elements[0]=O*v;a.elements[1]=(-aj*R+Q*am)*v;a.elements[2]=(D*R-Q*F)*v;a.elements[3]=n*v;a.elements[4]=(aj*S-Q*ap)*v;a.elements[5]=(-D*S+Q*I)*v;a.elements[6]=Z*v;a.elements[7]=(-am*S+R*ap)*v;a.elements[8]=(F*S-R*I)*v;return a},scale:function(b,a){aa=arguments.length;if(aa<=1){a=b}return this.multiply(b,0,0,0,a,0,0,0,1)},rotate:function(a){at=k(a);Y=H(a);return this.multiply(at,-Y,0,Y,at,0,0,0,1)},translate:function(a,b){return this.multiply(1,0,a,0,1,b,0,0,1)},skewX:function(a){aw=X(a);return this.multiply(1,aw,0,0,1,0,0,0,1)},skewY:function(a){aw=X(a);return this.multiply(1,0,0,aw,1,0,0,0,1)},toString:function(a){this.toArray(a,P);return P.join(" ")},toArray:function(b,a){m=this.elements;o=!!a;aw=parseFloat(m[0].toFixed(3));av=parseFloat(m[1].toFixed(3));at=parseFloat(m[2].toFixed(3));aq=parseFloat(m[3].toFixed(3));an=parseFloat(m[4].toFixed(3));ak=parseFloat(m[5].toFixed(3));if(!!b){ah=parseFloat(m[6].toFixed(3));af=parseFloat(m[7].toFixed(3));ae=parseFloat(m[8].toFixed(3));if(o){a[0]=aw;a[1]=aq;a[2]=ah;a[3]=av;a[4]=an;a[5]=af;a[6]=at;a[7]=ak;a[8]=ae;return}return[aw,aq,ah,av,an,af,at,ak,ae]}if(o){a[0]=aw;a[1]=aq;a[2]=av;a[3]=an;a[4]=at;a[5]=ak;return}return[aw,aq,av,an,at,ak]},clone:function(){aw=this.elements[0];av=this.elements[1];at=this.elements[2];aq=this.elements[3];an=this.elements[4];ak=this.elements[5];ah=this.elements[6];af=this.elements[7];ae=this.elements[8];return new Two.Matrix(aw,av,at,aq,an,ak,ah,af,ae)}})})();(function(){var A=Two.Utils.mod,d,u,t,k,B,C,f,e,r,z,v,q,o,h,g,p,b,w,i,m,j,p,b;var n={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(c,a){B=c;u=document.createElementNS(this.ns,B);if(B==="svg"){a=_.defaults(a||{},{version:this.version})}if(_.isObject(a)){n.setAttributes(u,a)}return u},setAttribute:function(c,a){this.setAttribute(a,c)},setAttributes:function(c,a){_.each(a,n.setAttribute,c);return this},removeAttribute:function(c,a){this.removeAttribute(a)},removeAttributes:function(c,a){_.each(a,n.removeAttribute,c);return this},toString:function(x,c){var a=x.length,y=a-1;return _.map(x,function(O,I){var H;var G=c?A(I-1,a):Math.max(I-1,0);var J=c?A(I+1,a):Math.min(I+1,y);var Q=x[G];var L=x[J];var N,K,D,l,F,E,S,R;var P=O.x.toFixed(3);var M=O.y.toFixed(3);switch(O._command){case Two.Commands.close:H=Two.Commands.close;break;case Two.Commands.curve:var F=(Q.controls&&Q.controls.right)||Q;var E=(O.controls&&O.controls.left)||O;N=F.x.toFixed(3);K=F.y.toFixed(3);D=E.x.toFixed(3);l=E.y.toFixed(3);H=((I===0)?Two.Commands.move:Two.Commands.curve)+" "+N+" "+K+" "+D+" "+l+" "+P+" "+M;break;default:H=(I===0?Two.Commands.move:O._command)+" "+P+" "+M}if(I>=y&&c){if(O._command===Two.Commands.curve){S=(O.controls&&O.controls.right)||O;R=(L.controls&&L.controls.left)||L;N=S.x.toFixed(3);K=S.y.toFixed(3);D=R.x.toFixed(3);l=R.y.toFixed(3);P=L.x.toFixed(3);M=L.y.toFixed(3);H+=" C "+N+" "+K+" "+D+" "+l+" "+P+" "+M}H+=" Z"}return H}).join(" ")},group:{appendChild:function(a){u=this.domElement.querySelector("#"+Two.Identifier+a);if(u){this.elem.appendChild(u)}},removeChild:function(a){u=this.domElement.querySelector("#"+Two.Identifier+a);if(u){this.elem.removeChild(u)}},renderChild:function(a){n[a._renderer.type].render.call(a,this)},render:function(c){this.update();if(!this._renderer.elem){this._renderer.elem=n.createElement("g",{id:Two.Identifier+this.id});c.appendChild(this._renderer.elem)}d=this._matrix.manual||this._flagMatrix;var a={domElement:c,elem:this._renderer.elem};if(d){this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")")}_.each(this.children,n.group.renderChild,c);if(this._flagAdditions){_.each(this.additions,n.group.appendChild,a)}if(this._flagSubtractions){_.each(this.subtractions,n.group.removeChild,a)}return this.flagReset()}},polygon:{render:function(a){this.update();if(!this._renderer.elem){this._renderer.elem=n.createElement("path",{id:Two.Identifier+this.id});a.appendChild(this._renderer.elem)}u=this._renderer.elem;d=this._matrix.manual||this._flagMatrix;if(d){u.setAttribute("transform","matrix("+this._matrix.toString()+")")}if(this._flagVertices){vertices=n.toString(this._vertices,this._closed);u.setAttribute("d",vertices)}if(this._flagFill){u.setAttribute("fill",this._fill)}if(this._flagStroke){u.setAttribute("stroke",this._stroke)}if(this._flagLinewidth){u.setAttribute("stroke-width",this._linewidth)}if(this._flagOpacity){u.setAttribute("stroke-opacity",this._opacity);u.setAttribute("fill-opacity",this._opacity)}if(this._flagVisible){u.setAttribute("visibility",this._visible?"visible":"hidden")}if(this._flagCap){u.setAttribute("stroke-linecap",this._cap)}if(this._flagJoin){u.setAttribute("stroke-linejoin",this._join)}if(this._flagMiter){u.setAttribute("stroke-miterlimit",this.miter)}return this.flagReset()}}};var s=Two[Two.Types.svg]=function(a){this.domElement=a.domElement||n.createElement("svg");this.scene=new Two.Group();this.scene.parent=this};_.extend(s,{Utils:n});_.extend(s.prototype,Backbone.Events,{setSize:function(c,a){this.width=c;this.height=a;n.setAttributes(this.domElement,{width:c,height:a});return this},render:function(){n.group.render.call(this.scene,this.domElement);return this}})})();(function(){var B=this;var K=Two.Utils.mod;var F=Two.Utils.getRatio;var D,m,E,C,h,f,o,u,b,e,l,i,q;var z,w,J,H,k,j,v,t,s,d,I,n,r,p;var g={group:{renderChild:function(a){g[a._renderer.type].render.call(a,this)},render:function(a){this.update();D=this._matrix.elements;a.save();a.transform(D[0],D[3],D[1],D[4],D[2],D[5]);_.each(this.children,g.group.renderChild,a);a.restore();return this.flagReset()}},polygon:{render:function(a){this.update();D=this._matrix.elements;m=this.stroke;E=this.linewidth;C=this.fill;h=this.opacity;f=this.visible;o=this.cap;u=this.join;b=this.miter;e=this.closed;l=this._vertices;i=l.length;q=i-1;if(!f){return this}a.save();if(D){a.transform(D[0],D[3],D[1],D[4],D[2],D[5])}if(C){a.fillStyle=C}if(m){a.strokeStyle=m}if(E){a.lineWidth=E}if(b){a.miterLimit=b}if(u){a.lineJoin=u}if(o){a.lineCap=o}if(_.isNumber(h)){a.globalAlpha=h}a.beginPath();_.each(l,function(c,x){r=c.x.toFixed(3),p=c.y.toFixed(3);switch(c._command){case Two.Commands.close:a.closePath();break;case Two.Commands.curve:w=e?K(x-1,i):Math.max(x-1,0);z=e?K(x+1,i):Math.min(x+1,q);J=l[w],H=l[z];s=(J.controls&&J.controls.right)||J;d=(c.controls&&c.controls.left)||c;v=s.x.toFixed(3);t=s.y.toFixed(3);k=d.x.toFixed(3);j=d.y.toFixed(3);a.bezierCurveTo(v,t,k,j,r,p);if(x>=q&&e){I=(c.controls&&c.controls.right)||c;n=(H.controls&&H.controls.left)||H;v=I.x.toFixed(3);t=I.y.toFixed(3);k=n.x.toFixed(3);j=n.y.toFixed(3);r=H.x.toFixed(3);p=H.y.toFixed(3);a.bezierCurveTo(v,t,k,j,r,p)}break;case Two.Commands.line:a.lineTo(r,p);break;case Two.Commands.move:a.moveTo(r,p);break}});if(e){a.closePath()}a.fill();a.stroke();a.restore();return this.flagReset()}}};var A=Two[Two.Types.canvas]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.ctx=this.domElement.getContext("2d");this.overdraw=false;this.scene=new Two.Group();this.scene.parent=this};_.extend(A,{Utils:g});_.extend(A.prototype,Backbone.Events,{setSize:function(x,a,c){this.width=x;this.height=a;this.ratio=_.isUndefined(c)?F(this.ctx):c;this.domElement.width=x*this.ratio;this.domElement.height=a*this.ratio;_.extend(this.domElement.style,{width:x+"px",height:a+"px"});return this},render:function(){var a=this.ratio===1;if(!a){this.ctx.save();this.ctx.scale(this.ratio,this.ratio)}if(!this.overdraw){this.ctx.clearRect(0,0,this.width,this.height)}g.group.render.call(this.scene,this.ctx);if(!a){this.ctx.restore()}return this}});function G(a){a.setTransform(1,0,0,1,0,0)}})();(function(){var an=Two[Two.Types.canvas],Y=Two.Matrix.Multiply,k=Two.Utils.mod,ae=[1,0,0,0,1,0,0,0,1],ak=new Two.Array(9),V=Two.Utils.getRatio;var w,q,m,T,l,ag,p,g,aa,Z,aq,ap,am,al,K,N,H,f,i,W,r,F,Q,O,S,B,aj,X,v,U,ac,D,C,R,G,E,j,P,M,L,u,t,n,ai,af,e,ab,ao,s,J,z,ah,I,A,h;var ad={canvas:document.createElement("canvas"),uv:new Two.Array([0,0,1,0,0,1,0,1,1,0,1,1]),group:{renderChild:function(a){ad[a._renderer.type].render.call(a,this.gl,this.program)},render:function(b,a){this.update();w=this.parent;q=(w._matrix&&w._matrix.manual)||w._flagMatrix;m=this._matrix.manual||this._flagMatrix;if(q||m){if(!this._renderer.matrix){this._renderer.matrix=new Two.Array(9)}this._matrix.toArray(true,ak);Y(ak,w._renderer.matrix,this._renderer.matrix);this._renderer.scale=this._scale*w._renderer.scale;if(q){this._flagMatrix=true}}_.each(this.children,ad.group.renderChild,{gl:b,program:a});return this.flagReset()}},polygon:{render:function(b,a){if(!this._visible||!this._opacity){return this}w=this.parent;q=w._matrix.manual||w._flagMatrix;m=this._matrix.manual||this._flagMatrix;T=this._flagVertices||this._flagFill||this._flagStroke||this._flagLinewidth||this._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale;this.update();if(q||m){if(!this._renderer.matrix){this._renderer.matrix=new Two.Array(9)}this._matrix.toArray(true,ak);Y(ak,w._renderer.matrix,this._renderer.matrix);this._renderer.scale=this._scale*w._renderer.scale}if(T){if(!this._renderer.rect){this._renderer.rect={}}if(!this._renderer.triangles){this._renderer.triangles=new Two.Array(12)}ad.getBoundingClientRect(this._vertices,this._linewidth,this._renderer.rect);ad.getTriangles(this._renderer.rect,this._renderer.triangles);ad.updateBuffer(b,this,a);ad.updateTexture(b,this)}b.bindBuffer(b.ARRAY_BUFFER,this._renderer.textureCoordsBuffer);b.vertexAttribPointer(a.textureCoords,2,b.FLOAT,false,0,0);b.bindTexture(b.TEXTURE_2D,this._renderer.texture);b.uniformMatrix3fv(a.matrix,false,this._renderer.matrix);b.bindBuffer(b.ARRAY_BUFFER,this._renderer.buffer);b.vertexAttribPointer(a.position,2,b.FLOAT,false,0,0);b.drawArrays(b.TRIANGLES,0,6);return this.flagReset()}},getBoundingClientRect:function(b,a,c){l=Infinity,ag=-Infinity;p=Infinity,g=-Infinity;_.each(b,function(d,x){aa=d.x,Z=d.y,aq,ap,am,al,K=d.controls;p=Math.min(Z,p);l=Math.min(aa,l);ag=Math.max(aa,ag);g=Math.max(Z,g);if(!d.controls){return}N=K.left;H=K.right;if(!N||!H){return}aq=N.x,ap=N.y,am=H.x,al=H.y;if(!aq||!ap||!am||!al){return}p=Math.min(ap,al,p);l=Math.min(aq,am,l);ag=Math.max(aq,am,ag);g=Math.max(ap,al,g)});if(_.isNumber(a)){p-=a;l-=a;ag+=a;g+=a}f=ag-l;i=g-p;c.top=p;c.left=l;c.right=ag;c.bottom=g;c.width=f;c.height=i;if(!c.centroid){c.centroid={}}c.centroid.x=-l;c.centroid.y=-p},getTriangles:function(a,b){p=a.top;l=a.left;ag=a.right;g=a.bottom;b[0]=l;b[1]=p;b[2]=ag;b[3]=p;b[4]=l;b[5]=g;b[6]=l;b[7]=g;b[8]=ag;b[9]=p;b[10]=ag;b[11]=g},updateCanvas:function(a){W=a._vertices;r=this.canvas;F=this.ctx;Q=a._renderer.scale;O=a._stroke;S=a._linewidth*Q;B=a._fill;aj=a._opacity;X=a._cap;v=a._join;U=a._miter;ac=a._closed;D=W.length;C=D-1;r.width=Math.max(Math.ceil(a._renderer.rect.width*Q),1);r.height=Math.max(Math.ceil(a._renderer.rect.height*Q),1);R=a._renderer.rect.centroid;G=R.x*Q,E=R.y*Q;F.clearRect(0,0,r.width,r.height);if(B){F.fillStyle=B}if(O){F.strokeStyle=O}if(S){F.lineWidth=S}if(U){F.miterLimit=U}if(v){F.lineJoin=v}if(X){F.lineCap=X}if(_.isNumber(aj)){F.globalAlpha=aj}F.beginPath();_.each(W,function(c,d){j,P,aq,am,M,L,u,t,n,ai,af,N;aa=(c.x*Q+G).toFixed(3),Z=(c.y*Q+E).toFixed(3);switch(c._command){case Two.Commands.close:F.closePath();break;case Two.Commands.curve:P=ac?k(d-1,D):Math.max(d-1,0);j=ac?k(d+1,D):Math.min(d+1,C);aq=W[P],am=W[j];n=(aq.controls&&aq.controls.right)||aq;ai=(c.controls&&c.controls.left)||c;u=(n.x*Q+G).toFixed(3);t=(n.y*Q+E).toFixed(3);M=(ai.x*Q+G).toFixed(3);L=(ai.y*Q+E).toFixed(3);F.bezierCurveTo(u,t,M,L,aa,Z);if(d>=C&&ac){af=(c.controls&&c.controls.right)||c;N=(am.controls&&am.controls.left)||am;u=(af.x*Q+G).toFixed(3);t=(af.y*Q+E).toFixed(3);M=(N.x*Q+G).toFixed(3);L=(N.y*Q+E).toFixed(3);aa=(am.x*Q+G).toFixed(3);Z=(am.y*Q+E).toFixed(3);F.bezierCurveTo(u,t,M,L,aa,Z)}break;case Two.Commands.line:F.lineTo(aa,Z);break;case Two.Commands.move:F.moveTo(aa,Z);break}});if(ac){F.closePath()}F.fill();F.stroke()},updateTexture:function(b,a){this.updateCanvas(a);if(a._renderer.texture){b.deleteTexture(a._renderer.texture)}b.bindBuffer(b.ARRAY_BUFFER,a._renderer.textureCoordsBuffer);a._renderer.texture=b.createTexture();b.bindTexture(b.TEXTURE_2D,a._renderer.texture);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);if(this.canvas.width<=0||this.canvas.height<=0){return}b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,this.canvas)},updateBuffer:function(c,b,a){if(_.isObject(b._renderer.buffer)){c.deleteBuffer(b._renderer.buffer)}b._renderer.buffer=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,b._renderer.buffer);c.enableVertexAttribArray(a.position);c.bufferData(c.ARRAY_BUFFER,b._renderer.triangles,c.STATIC_DRAW);if(_.isObject(b._renderer.textureCoordsBuffer)){c.deleteBuffer(b._renderer.textureCoordsBuffer)}b._renderer.textureCoordsBuffer=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,b._renderer.textureCoordsBuffer);c.enableVertexAttribArray(a.textureCoords);c.bufferData(c.ARRAY_BUFFER,this.uv,c.STATIC_DRAW)},program:{create:function(b,a){e=b.createProgram();_.each(a,function(c){b.attachShader(e,c)});b.linkProgram(e);ab=b.getProgramParameter(e,b.LINK_STATUS);if(!ab){J=b.getProgramInfoLog(e);b.deleteProgram(e);throw new Two.Utils.Error("unable to link program: "+J)}return e}},shaders:{create:function(c,b,a){ao=c.createShader(c[a]);c.shaderSource(ao,b);c.compileShader(ao);s=c.getShaderParameter(ao,c.COMPILE_STATUS);if(!s){J=c.getShaderInfoLog(ao);c.deleteShader(ao);throw new Two.Utils.Error("unable to compile shader "+ao+": "+J)}return ao},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},vertex:["attribute vec2 a_position;","attribute vec2 a_textureCoords;","","uniform mat3 u_matrix;","uniform vec2 u_resolution;","","varying vec2 v_textureCoords;","","void main() {","   vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;","   vec2 normal = projected / u_resolution;","   vec2 clipspace = (normal * 2.0) - 1.0;","","   gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);","   v_textureCoords = a_textureCoords;","}"].join("\n"),fragment:["precision mediump float;","","uniform sampler2D u_image;","varying vec2 v_textureCoords;","","void main() {","  gl_FragColor = texture2D(u_image, v_textureCoords);","}"].join("\n")}};ad.ctx=ad.canvas.getContext("2d");var o=Two[Two.Types.webgl]=function(a){this.domElement=a.domElement||document.createElement("canvas");this.scene=new Two.Group();this.scene.parent=this;this._renderer={matrix:new Two.Array(ae),scale:1};this._flagMatrix=true;h=_.defaults(a||{},{antialias:false,alpha:true,premultipliedAlpha:true,stencil:true,preserveDrawingBuffer:true,overdraw:false});this.overdraw=h.overdraw;z=this.ctx=this.domElement.getContext("webgl",h)||this.domElement.getContext("experimental-webgl",h);if(!this.ctx){throw new Two.Utils.Error("unable to create a webgl context. Try using another renderer.")}A=ad.shaders.create(z,ad.shaders.vertex,ad.shaders.types.vertex);I=ad.shaders.create(z,ad.shaders.fragment,ad.shaders.types.fragment);this.program=ad.program.create(z,[A,I]);z.useProgram(this.program);this.program.position=z.getAttribLocation(this.program,"a_position");this.program.matrix=z.getUniformLocation(this.program,"u_matrix");this.program.textureCoords=z.getAttribLocation(this.program,"a_textureCoords");z.disable(z.DEPTH_TEST);z.enable(z.BLEND);z.blendEquationSeparate(z.FUNC_ADD,z.FUNC_ADD);z.blendFuncSeparate(z.SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA,z.ONE,z.ONE_MINUS_SRC_ALPHA)};_.extend(o.prototype,Backbone.Events,{setSize:function(c,a,b){this.width=c;this.height=a;this.ratio=_.isUndefined(b)?V(this.ctx):b;this.domElement.width=c*this.ratio;this.domElement.height=a*this.ratio;_.extend(this.domElement.style,{width:c+"px",height:a+"px"});c*=this.ratio;a*=this.ratio;this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio;this._flagMatrix=true;this.ctx.viewport(0,0,c,a);ah=this.ctx.getUniformLocation(this.program,"u_resolution");this.ctx.uniform2f(ah,c,a);return this},render:function(){z=this.ctx;if(!this.overdraw){z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT)}ad.group.render.call(this.scene,z,this.program);this._flagMatrix=false;return this}})})();(function(){var a=new Two.Vector(),c;var b=Two.Shape=function(d){this._renderer={};this.id=Two.uniqueId();this._matrix=new Two.Matrix();this.translation=new Two.Vector();this.translation.bind(Two.Events.change,_.bind(b.FlagMatrix,this));this.rotation=0;this.scale=1};_.extend(b,Backbone.Events,{FlagMatrix:function(){this._flagMatrix=true},MakeObservable:function(d){Object.defineProperty(d,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation=e;this._flagMatrix=true}});Object.defineProperty(d,"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this._flagMatrix=true;this._flagScale=true}})}});_.extend(b.prototype,{_flagMatrix:true,_rotation:0,_scale:1,addTo:function(d){d.add(this);return this},clone:function(){c=new b();c.translation.copy(this.translation);c.rotation=this.rotation;c.scale=this.scale;_.each(b.Properties,function(d){c[d]=this[d]},this);return c.update()},update:function(){if(!this._matrix.manual&&this._flagMatrix){this._matrix.identity().translate(this.translation.x,this.translation.y).scale(this.scale).rotate(this.rotation)}return this},flagReset:function(){this._flagMatrix=false;this._flagScale=false;return this}});b.MakeObservable(b.prototype)})();(function(){var O=Math.min,t=Math.max,K=Math.round,u=Two.Utils.getComputedMatrix;var J,C,B,r,H,G,L,j,D,s,w,A,k,h,f,I,g,e,F,E,R,Q,N,M,z,q,U,p,T,o,S,n,P;var m=Two.Polygon=function(c,b,a,d){Two.Shape.call(this);this._renderer.type="polygon";this._closed=!!b;this._curved=!!a;this.beginning=0;this.ending=1;this.fill="#fff";this.stroke="#000";this.linewidth=1;this.opacity=1;this.visible=true;this.cap="round";this.join="round";this.miter=4;this._vertices=[];this.vertices=c;this.automatic=!d};_.extend(m,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],FlagVertices:function(){this._flagVertices=true},MakeObservable:function(a){Two.Shape.MakeObservable(a);_.each(m.Properties.slice(0,8),function(d){var c="_"+d;var b="_flag"+d.charAt(0).toUpperCase()+d.slice(1);Object.defineProperty(a,d,{get:function(){return this[c]},set:function(i){this[c]=i;this[b]=true}})});Object.defineProperty(a,"closed",{get:function(){return this._closed},set:function(b){this._closed=!!b;this._flagVertices=true}});Object.defineProperty(a,"curved",{get:function(){return this._curved},set:function(b){this._curved=!!b;this._flagVertices=true}});Object.defineProperty(m.prototype,"automatic",{get:function(){return this._automatic},set:function(b){if(b===this._automatic){return}this._automatic=!!b;method=this._automatic?"ignore":"listen";_.each(this.vertices,function(c){c[method]()})}});Object.defineProperty(a,"beginning",{get:function(){return this._beginning},set:function(b){this._beginning=O(t(b,0),1);this._flagVertices=true}});Object.defineProperty(a,"ending",{get:function(){return this._ending},set:function(b){this._ending=O(t(b,0),1);this._flagVertices=true}});Object.defineProperty(a,"vertices",{get:function(){return this._collection},set:function(c){var i=_.bind(m.FlagVertices,this);var b=_.bind(function(l){_.each(l,function(x){x.bind(Two.Events.change,i)},this);i()},this);var d=_.bind(function(l){_.each(l,function(x){x.unbind(Two.Events.change,i)},this);i()},this);if(this._collection){this._collection.unbind()}this._collection=new Two.Utils.Collection(c.slice(0));this._collection.bind(Two.Events.insert,b);this._collection.bind(Two.Events.remove,d);verticesChanged=true;b(this._collection)}})}});_.extend(m.prototype,Two.Shape.prototype,{_flagVertices:true,_flagFill:true,_flagStroke:true,_flagLinewidth:true,_flagOpacity:true,_flagVisible:true,_flagCap:true,_flagJoin:true,_flagMiter:true,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:true,_cap:"round",_join:"round",_miter:4,_closed:true,_curved:false,_automatic:true,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;D=_.map(this.vertices,function(b){return b.clone()});s=new m(D,this.closed,this.curved,!this.automatic);_.each(Two.Shape.Properties,function(b){s[b]=this[b]},this);s.translation.copy(this.translation);s.rotation=this.rotation;s.scale=this.scale;a.add(s);return s},noFill:function(){this.fill="transparent";return this},noStroke:function(){this.stroke="transparent";return this},corner:function(){w=this.getBoundingClientRect(true);w.centroid={x:w.left+w.width/2,y:w.top+w.height/2};_.each(this.vertices,function(a){a.addSelf(w.centroid)});return this},center:function(){w=this.getBoundingClientRect(true);w.centroid={x:w.left+w.width/2,y:w.top+w.height/2};_.each(this.vertices,function(a){a.subSelf(w.centroid)});return this},remove:function(){if(!this.parent){return this}this.parent.remove(this);return this},getBoundingClientRect:function(a){this.update();k=this.linewidth/2,h;f=Infinity,I=-Infinity;g=Infinity,e=-Infinity;_.each(this._vertices,function(b){F=b.x,E=b.y;g=O(E,g);f=O(F,f);I=t(F,I);e=t(E,e)});g-=k;f-=k;I+=k;e+=k;z=!!a?this._matrix:u(this);R=z.multiply(f,g,1);Q=z.multiply(I,g,1);N=z.multiply(I,e,1);M=z.multiply(f,e,1);g=O(R.y,Q.y,N.y,M.y);f=O(R.x,Q.x,N.x,M.x);I=t(R.x,Q.x,N.x,M.x);e=t(R.y,Q.y,N.y,M.y);return{top:g,left:f,right:I,bottom:e,width:I-f,height:e-g}},plot:function(){if(this.curved){Two.Utils.getCurveFromPoints(this.vertices,this.closed);return this}_.each(this.vertices,function(b,a){b._command=a===0?Two.Commands.move:Two.Commands.line},this);return this},subdivide:function(a){this.update();r=this.vertices.length-1;Q=this.vertices[r];H=this._closed||this.vertices[r].command===Two.Commands.close;D=[];_.each(this.vertices,function(b,c){if((c<=0&&!H)||b.command===Two.Commands.move){D.push(new Two.Anchor(Q.x,Q.y));D[D.length-1].command=Two.Commands.line;Q=b;return}I=Q.controls&&Q.controls.right;f=b.controls&&b.controls.left;q=Q.x,U=Q.y;p=(I||Q).x,T=(I||Q).y;o=(f||b).x,S=(f||b).y;n=b.x,P=b.y;var d=Two.Utils.subdivide(q,U,p,T,o,S,n,P,a);D=D.concat(d);_.each(d,function(l,x){if(x<=0&&Q.command===Two.Commands.move){l.command=Two.Commands.move}else{l.command=Two.Commands.line}});if(c>=r){D.push(new Two.Anchor(n,P));D[D.length-1].command=H?Two.Commands.close:Two.Commands.line}Q=b},this);this._automatic=false;this._curved=false;this.vertices=D;return this},update:function(){if(this._flagVertices){if(this._automatic){this.plot()}J=this.vertices.length;r=J-1;C=K((this._beginning)*r);B=K((this._ending)*r);this._vertices.length=0;for(L=C;L<B+1;L++){G=this.vertices[L];this._vertices.push(G)}}Two.Shape.prototype.update.call(this);return this},flagReset:function(){this._flagVertices=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=false;Two.Shape.prototype.flagReset.call(this);return this}});m.MakeObservable(m.prototype)})();(function(){var u=Math.min,x=Math.max;var h,p,j,o,g,m,v,e,f,t,r,i,A,q,n,w,C,B,z,y,k;var s=Two.Group=function(a){Two.Shape.call(this,true);this._renderer.type="group";this.additions=[];this.subtractions=[];this.children={}};_.extend(s,{MakeObservable:function(a){Two.Shape.MakeObservable(a);s.MakeGetterSetter(a,Two.Polygon.Properties)},MakeGetterSetter:function(b,a){if(!_.isArray(a)){a=[a]}_.each(a,function(c){h="_"+c;Object.defineProperty(b,c,{get:function(){return this[h]},set:function(d){this[h]=d;_.each(this.children,function(l){l[c]=d})}})})}});_.extend(s.prototype,Two.Shape.prototype,{_flagAdditions:false,_flagSubtractions:false,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:true,_cap:"round",_join:"round",_miter:4,_closed:true,_curved:false,_automatic:true,_beginning:0,_ending:1,clone:function(a){a=a||this.parent;j=_.map(this.children,function(b){return b.clone()});o=new s();a.add(o);o.add(j);o.translation.copy(this.translation);o.rotation=this.rotation;o.scale=this.scale;return o},corner:function(){g=this.getBoundingClientRect(true);m={x:g.left,y:g.top};_.each(this.children,function(a){a.translation.subSelf(m)});return this},center:function(){g=this.getBoundingClientRect(true);g.centroid={x:g.left+g.width/2,y:g.top+g.height/2};_.each(this.children,function(a){a.translation.subSelf(g.centroid)});return this},add:function(a){v=arguments.length,e=a,j=this.children,f=this.parent,t=this.additions;if(!_.isArray(a)){e=_.toArray(arguments)}_.each(e,function(b){if(!b){return}r=b.id,p=b.parent;if(_.isUndefined(j[r])){if(p){delete p.children[r];k=_.indexOf(p.additions,r);if(k>=0){p.additions.splice(k,1)}}j[r]=b;b.parent=this;t.push(r);this._flagAdditions=true}},this);return this},remove:function(a){v=arguments.length,e=a,j=this.children,f=this.parent,t=this.subtractions;if(v<=0&&f){f.remove(this);return this}if(!_.isArray(a)){e=_.toArray(arguments)}_.each(e,function(b){r=b.id,grandchildren=b.children;p=b.parent;if(!(r in j)){return}delete j[r];delete b.parent;k=_.indexOf(p.additions,r);if(k>=0){p.additions.splice(k,1)}t.push(r);this._flagSubtractions=true},this);return this},getBoundingClientRect:function(a){this.update();i=Infinity,A=-Infinity;q=Infinity,n=-Infinity;_.each(this.children,function(b){g=b.getBoundingClientRect(true);if(!_.isNumber(g.top)||!_.isNumber(g.left)||!_.isNumber(g.right)||!_.isNumber(g.bottom)){return}q=u(g.top,q);i=u(g.left,i);A=x(g.right,A);n=x(g.bottom,n)},this);w=!!a?this._matrix:Two.Utils.getComputedMatrix(this);C=w.multiply(i,q,1);B=w.multiply(A,q,1);z=w.multiply(A,n,1);y=w.multiply(i,n,1);q=u(C.y,B.y,z.y,y.y);i=u(C.x,B.x,z.x,y.x);A=x(C.x,B.x,z.x,y.x);n=x(C.y,B.y,z.y,y.y);return{top:q,left:i,right:A,bottom:n,width:A-i,height:n-q}},noFill:function(){_.each(this.children,function(a){a.noFill()});return this},noStroke:function(){_.each(this.children,function(a){a.noStroke()});return this},subdivide:function(){var a=arguments;_.each(this.children,function(b){b.subdivide.apply(b,a)});return this},flagReset:function(){if(this._flagAdditions){this.additions.length=0;this._flagAdditions=false}if(this._flagSubtractions){this.subtractions.length=0;this._flagSubtractions=false}Two.Shape.prototype.flagReset.call(this);return this}});s.MakeObservable(s.prototype)})();